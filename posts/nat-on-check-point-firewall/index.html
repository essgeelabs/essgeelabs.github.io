<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>NAT on Check Point Firewall | Ess Gee Labs</title>
<meta name="keywords" content="lab, networking, firewalls, cybersecurity">
<meta name="description" content="In this final part of the basic setup of a Check Point firewall, I walk through NAT configurations.">
<meta name="author" content="Sachin Ganpat">
<link rel="canonical" href="https://essgeelabs.com/posts/nat-on-check-point-firewall/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css" integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js" integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93&#43;QdxBJM917LmaT3s9E="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://essgeelabs.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://essgeelabs.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://essgeelabs.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://essgeelabs.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://essgeelabs.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RLGK7M9LKK"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-RLGK7M9LKK', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="NAT on Check Point Firewall" />
<meta property="og:description" content="In this final part of the basic setup of a Check Point firewall, I walk through NAT configurations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://essgeelabs.com/posts/nat-on-check-point-firewall/" />
<meta property="og:image" content="https://essgeelabs.com/posts/nat-on-check-point-firewall/images/cp_logo.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-03T20:00:00-04:00" />
<meta property="article:modified_time" content="2022-07-03T20:00:00-04:00" /><meta property="og:site_name" content="EssGeeLabs" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://essgeelabs.com/posts/nat-on-check-point-firewall/images/cp_logo.png" />
<meta name="twitter:title" content="NAT on Check Point Firewall"/>
<meta name="twitter:description" content="In this final part of the basic setup of a Check Point firewall, I walk through NAT configurations."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://essgeelabs.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "NAT on Check Point Firewall",
      "item": "https://essgeelabs.com/posts/nat-on-check-point-firewall/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "NAT on Check Point Firewall",
  "name": "NAT on Check Point Firewall",
  "description": "In this final part of the basic setup of a Check Point firewall, I walk through NAT configurations.",
  "keywords": [
    "lab", "networking", "firewalls", "cybersecurity"
  ],
  "articleBody": "In this final part of the basic setup of a Check Point firewall I’ll be talking about Network Address Translation, or NAT.\nWhat is NAT When a IP packet traverses a network, the IP packet header has the Source IP address, Destination IP address, Source Port, and Destination Port, among other things. When this packet traverses routers this information is usually unchanged.\nHowever, there are cases where this information may need to be changed, mainly when traversing network boundaries from private to public networks. Most private networks utilise RFC 1918 addresses, which define private IP addresses as:\n192.168.0.0/16 172.16.0.0/12 10.0.0.0/8 These addresses are not routable over the public Internet and must therefore be mapped, or translated, to a proper public IP address. This is where NAT comes in.\nIn the diagram below (highlighted in red), it shows a packet leaving from A destined to B with a source IP of 192.168.1.10, which is not allowed over the Internet. The NAT device changes that IP to 200.200.200.10, and sends it over the Internet. When the packet is received, the NAT device translates the destination IP to the correct destination on the inside.\nThe NAT device must therefore maintain the state information of the flow to properly perform the translations.\nTypes of NAT There are two broad categories of NAT.\nStatic, or 1-to-1, NAT is where there is a single mapping between a source and the translated address. No other host utilises that translated address. Dynamic NAT, or NAT overload, is where multiple devices are mapped to a single, or a group of translated addresses. The number of devices mapped is greater than the number of translated addresses. This also implies that Port Address Translation, PAT, is utilised as source ports need to be assigned dynamically. PAT is shown in the diagram above (highlighted in yellow) where port 8080 is translated to port 80. With this basic overview, let’s get to implementing on the Check Point firewall.\nLab setup To illustrate the different types of NAT and the features of Check Point to implement, we will utilise the lab as below.\nComing out of the basic setup, some additional rules were added as shown below, including section titles for readability.\nIf you look at the NAT rules, only automatic rules are configured for now.\nAs a reminder, these automatic rules are created based on the NAT configuration of the network or host objects. In my case, the DMZ_Net and Internal_Net objects are both configured with “Add automatic address translation rules”.\nThere are two translation methods:\nHide - Dynamic NAT Static - Static NAT When you choose static NAT, you can specify an IP address that the object will be translated to, regardless of what network is communicating with it. I generally don’t use this and prefer to create manual NAT rules, but this depends on the complexity of the setup.\nNetwork Behaviour From the windows client I can access the file share of the external file server at 192.168.200.15, which is allowed via rule 5.\nIf you view the connections on the file server you will see the client IP as the IP address of the firewall (192.168.200.1 in this case). This is the “hide” action.\nIf I SSH from the internal file server to the external file server the client IP for that connection will also show up at the firewall IP address.\nIf you look at the log entry in the SmartLog you will see the NAT rule number matched as the automatic rule (Rule 6 in my case).\nCreate a manual NAT rule. Let’s create a NAT entry that will translate the IP of the internal file server to 192.168.200.200 when connecting to the DMZ network instead of hiding behind the firewall IP address.\nFirst start by creating an object with the translated IP address. Only configuring the name and IP address are required. Don’t configure anything else.\nNow add a rule to the top by clicking on the “add rule” button and choosing “Add rule to top”.\nCreate a rule as shown below:\nOriginal Source –\u003e Internal Fileserver Original Destination –\u003e DMZ network Translated Source –\u003e Translated IP host object created above Translated Destination –\u003e Original And install the policy. NAT rules like any rule, needs to the policy to be installed before becoming active.\nNow from the internal file server try to SSH to the external file server.\nHmmm, it doesn’t seem to work. Maybe it’s not allowed? Let’s check the log.\nThe log entry seems to indicate that the traffic is allowed. And the translation is correct, the internal file server is being translated to 192.168.200.200 and it’s matching NAT rule 1.\nIf you look at the ARP table on the external file server, you will see that the ARP entry for 192.168.200.200 is incomplete. The external file server sees that that IP is on its local network and is sending out an ARP request, but is getting no response.\nThis is because the firewall needs to be configured for Proxy ARP to respond to ARP requests that it does not “own”.\nAs of Check Point R80.10 you can configure the firewall for the automatic creation of proxy ARP for manual NAT rules as per SK114395.\nThis requires connecting in expert mode, which you can access via the “CLI” icon in the web interface, or by an SSH connection to the firewall from a PC. I prefer the latter as the web-based “CLI” sucks.\nIf you’re not comfortable with using the CLI, then you can add manual proxy ARP entries based on sk30197 using the Gaia web interface.\nGo to “Network Management” –\u003e “ARP”. Then in the “Proxy ARP” section click “Add” to add your entry. Note that you need to install your policy in order for this to take effect.\nYou will also need to go to the “NAT” pane of the “Global Properties” and ensure that “Merge manual proxy ARP configuration” is checked.\nI opted to go with the automatic option because the CLI doesn’t scare me, and I didn’t want add proxy ARP setting every time.\nYou should also note that these settings don’t keep with upgrades, so you’ll need to recreate them when you do an upgrade.\nOnce the proxy ARP is setup, we can try to connect via SSH and it should work now. You may need to install your policy if it doesn’t work, otherwise, recheck your settings.\nIf you look at the ARP table on the server, you’ll see that the ARP entry is now showing. And if you check your connections you’ll see the client IP as the translated IP (192.168.200.200 in my case).\nI’ll create the reverse connection that we’ll utilise later. Here I’m not only configuring the reverse connection from the DMZ network to the NAT entry for the internal file server, but also maintaining the real IP address of the DMZ host when connecting, so it’s not being translated by the automatic rules.\nDynamic NAT When my two Linux clients SSH to the external file server, their IPs are being hidden by the firewall’s IP address. Suppose I want to hide these clients behind a different IP for some reason. Let’s do that.\nFirst, create a host object with the translated IP that we’ll use, in this case 192.168.200.210.\nThen create a rule by setting the translated source as the NAT object created above. Then install the policy.\nOh, oh. It seems that the policy install failed. Click on “Details” to see more about why.\nIt failed because the range size is not the same. This is because by default Check Point will set the translated objects as static NAT and you need to change the Dynamic NAT.\nGo to the NAT rule and right-click on the translated source object. Go to “NAT Method” and choose “Hide”. This sets the NAT entry to dynamic.\nThe entry will now show a little “H” instead of “S” to indicate “Hide”.\nNow when you install the policy it should install successfully.\nNow when the clients connect to the external file server, the connection entries show the translated IP of 192.168.200.210.\nIf you connect from the internal file server it still shows as 192.168.200.200. This is because that NAT rule is above the client rule we just created. If we put the new client NAT rule at the top, then all the connections, even from the internal file server, would show to come from 192.168.200.210.\nNo NAT I would have created a rule to allow the external file server to access the internal file server via SSH and disabled it. You can disable or enable a rule by right-clicking on it and selecting “Disable”. Disabled rules are shown as “greyed out”.\nThe rule allows access from the real IP of the external file server, to the real IP of the internal file server.\nWhen the connection is attempted it’s successful, and viewing the connection table on the internal file server shows the client IP as the firewall IP address.\nSo even though we’ve created as static NAT for the internal file server when connecting to the DMZ and vice-versa it doesn’t prevent connections to the real IP address if the rules allow it.\nWhen you try to connect to the translated IP of the internal file server it is not successful.\nReviewing the log entries shows the connection to the real IP as allowed, but the connection to the translated IP as denied.\nTo allow only access to the translated IP the rule must be altered with the destination as the NAT host object as shown below.\nNow a reattempt to SSH to the translated IP 192.168.200.200 is successful.\nAnd the connection table on the file server shows the connection coming from 192.168.200.15, which is expected as the NAT rule 2 had the translated source as “original”, which means unchanged.\nThe logs show the access is allowed via rule 7.\nAnd the log details show that the NAT rule 2 is being matched as expected.\nPAT and hosting services on the firewall IP As is typical now, many Internet Service Providers (ISP) limit the number of public IP addresses that they provide to customers, and nowadays you may have only one public IP to use. This public IP is the one used on the firewall. So if you have services hosted internally that you want to make public, how would you do that?\nHere is where PAT comes in. It allows you to create NAT rules for ports only to allow you allow the traffic through.\nIn the lab I have a web server hosted at 192.168.200.10.\nCreate a NAT rule for traffic to the destination as the firewall gateway object and original service as the service you’re allowing through, in my case HTTP (port 80). The translated destination is the webserver object, and it’s left as static NAT.\nNote that if the firewall object does not use the external IP as the main definition, then you will need to create an object with that IP to use as the original destination.\nNow go to the security policy and create a rule to allow access to the firewall object (or IP object if necessary), setting the service, in this case HTTP.\nOh oh, another error on policy install. This time it says that the rule 3 conflicts with rule 8.\nThe reason is that rule 3 blocks the traffic to the gateway object, so that rule 8 is not effective. This is one of the things I like with Check Point validation - it’s very good.\nTo fix this I need to move the rule above the stealth rule, as the traffic is destined to the firewall itself.\nNow my policy installed successfully, and you should be able to access the exposed server via the IP address of the firewall, in my case 192.168.1.41.\nNow, let’s say I want to access the web server securely using HTTPS. However, I have an issue as the default HTTPS port is being utilised by Gaia. Yes, I could change the default port for Gaia to something else (and this is very much recommended practice), but I will server the HTTPS page of my web server using port 8080 instead.\nI create another NAT rule, but this time I set the original service as HTTPS_proxy, which is TCP port 8080, and set the translated service as https.\nThen modify the access rule to allow HTTPS_proxy in the services, and install the policy.\nNow I can access the web page by going to https:\\\\192.168.1.41:8080.\nIn conclusion There are much more to Check Point than just this small series, but these basic items will get you though 80% or more of the things you need to do.\nAs time progresses I’ll post more stuff such as distributed setups, the IPS (which I still lovingly call SYNDefender) and Identity Awareness. I also want to explore some of the newer features with the networking components as I’ve never thought that Check Point’s network functionality was strong and what to see if that has changed.\nI hope you’ve found this helpful. Feel free to connect with me and give me feedback.\n",
  "wordCount" : "2193",
  "inLanguage": "en",
  "image":"https://essgeelabs.com/posts/nat-on-check-point-firewall/images/cp_logo.png","datePublished": "2022-07-03T20:00:00-04:00",
  "dateModified": "2022-07-03T20:00:00-04:00",
  "author":{
    "@type": "Person",
    "name": "Sachin Ganpat"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://essgeelabs.com/posts/nat-on-check-point-firewall/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ess Gee Labs",
    "logo": {
      "@type": "ImageObject",
      "url": "https://essgeelabs.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://essgeelabs.com/" accesskey="h" title="Ess Gee Labs (Alt + H)">Ess Gee Labs</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.sachinganpat.com" title="personal website">
                    <span>personal website</span>
                </a>
            </li>
            <li>
                <a href="https://www.interxect.com" title="business website">
                    <span>business website</span>
                </a>
            </li>
            <li>
                <a href="https://essgeelabs.com/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://essgeelabs.com/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://essgeelabs.com/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://essgeelabs.com/">Home</a>&nbsp;»&nbsp;<a href="https://essgeelabs.com/posts/">Posts</a></div>
    <h1 class="post-title">
      NAT on Check Point Firewall
    </h1>
    <div class="post-meta"><span title='2022-07-03 20:00:00 -0400 -04'>July 3, 2022</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;Sachin Ganpat&nbsp;|&nbsp;<a href="https://github.com/essgeelabs/essgeelabs/tree/master/content/posts/nat-on-check-point-firewall/index.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="lazy" srcset="https://essgeelabs.com/posts/nat-on-check-point-firewall/images/cp_logo_hu56c6468098172855cec4cc50c5eea2ec_26489_360x0_resize_box_3.png 360w ,https://essgeelabs.com/posts/nat-on-check-point-firewall/images/cp_logo_hu56c6468098172855cec4cc50c5eea2ec_26489_480x0_resize_box_3.png 480w ,https://essgeelabs.com/posts/nat-on-check-point-firewall/images/cp_logo_hu56c6468098172855cec4cc50c5eea2ec_26489_720x0_resize_box_3.png 720w ,https://essgeelabs.com/posts/nat-on-check-point-firewall/images/cp_logo.png 720w" 
            sizes="(min-width: 768px) 720px, 100vw" src="https://essgeelabs.com/posts/nat-on-check-point-firewall/images/cp_logo.png" alt="Check Point Logo" 
            width="720" height="360">
        
</figure>
  <div class="post-content"><p>In this final part of the basic setup of a Check Point firewall I&rsquo;ll be talking about Network Address Translation, or NAT.</p>
<h2 id="what-is-nat">What is NAT<a hidden class="anchor" aria-hidden="true" href="#what-is-nat">#</a></h2>
<p>When a IP packet traverses a network, the IP packet header has the Source IP address, Destination IP address, Source Port, and Destination Port, among other things. When this packet traverses routers this information is usually unchanged.</p>
<p>However, there are cases where this information may need to be changed, mainly when traversing network boundaries from private to public networks. Most private networks utilise RFC 1918 addresses, which define private IP addresses as:</p>
<ul>
<li>192.168.0.0/16</li>
<li>172.16.0.0/12</li>
<li>10.0.0.0/8</li>
</ul>
<p>These addresses are not routable over the public Internet and must therefore be mapped, or translated, to a proper public IP address. This is where NAT comes in.</p>
<p>In the diagram below (highlighted in red), it shows a packet leaving from A destined to B with a source IP of 192.168.1.10, which is not allowed over the Internet. The NAT device changes that IP to 200.200.200.10, and sends it over the Internet. When the packet is received, the NAT device translates the destination IP to the correct destination on the inside.</p>
<p>The NAT device must therefore maintain the state information of the flow to properly perform the translations.</p>
<p><img loading="lazy" src="images/02.png" alt="NAT in action"  />
</p>
<h3 id="types-of-nat">Types of NAT<a hidden class="anchor" aria-hidden="true" href="#types-of-nat">#</a></h3>
<p>There are two broad categories of NAT.</p>
<ul>
<li>Static, or 1-to-1, NAT is where there is a single mapping between a source and the translated address. No other host utilises that translated address.</li>
<li>Dynamic NAT, or NAT overload, is where multiple devices are mapped to a single, or a group of translated addresses. The number of devices mapped is greater than the number of translated addresses. This also implies that Port Address Translation, PAT, is utilised as source ports need to be assigned dynamically. PAT is shown in the diagram above (highlighted in yellow) where port 8080 is translated to port 80.</li>
</ul>
<p>With this basic overview, let&rsquo;s get to implementing on the Check Point firewall.</p>
<h2 id="lab-setup">Lab setup<a hidden class="anchor" aria-hidden="true" href="#lab-setup">#</a></h2>
<p>To illustrate the different types of NAT and the features of Check Point to implement, we will utilise the lab as below.</p>
<p><img loading="lazy" src="images/01.png" alt="Lab Setup"  />
</p>
<p>Coming out of <a href="https://essgeelabs.com/posts/configure-your-check-point-firewall/">the basic setup</a>, some additional rules were added as shown below, including section titles for readability.</p>
<p><img loading="lazy" src="images/03.png" alt="Initial rule setup"  />
</p>
<p>If you look at the NAT rules, only automatic rules are configured for now.</p>
<p><img loading="lazy" src="images/04.png" alt="NAT rules"  />
</p>
<p>As a reminder, these automatic rules are created based on the NAT configuration of the network or host objects. In my case, the <code>DMZ_Net</code> and <code>Internal_Net</code> objects are both configured with &ldquo;Add automatic address translation rules&rdquo;.</p>
<p>There are two translation methods:</p>
<ul>
<li>Hide - Dynamic NAT</li>
<li>Static - Static NAT</li>
</ul>
<p>When you choose static NAT, you can specify an IP address that the object will be translated to, regardless of what network is communicating with it. I generally don&rsquo;t use this and prefer to create manual NAT rules, but this depends on the complexity of the setup.</p>
<p><img loading="lazy" src="images/05.png" alt="DMZ Net NAT"  />
</p>
<p><img loading="lazy" src="images/06.png" alt="Internal Net NAT"  />
</p>
<h2 id="network-behaviour">Network Behaviour<a hidden class="anchor" aria-hidden="true" href="#network-behaviour">#</a></h2>
<p>From the windows client I can access the file share of the external file server at <code>192.168.200.15</code>, which is allowed via rule 5.</p>
<p><img loading="lazy" src="images/07.png" alt="file sharing works"  />
</p>
<p>If you view the connections on the file server you will see the client IP as the IP address of the firewall (<code>192.168.200.1</code> in this case). This is the &ldquo;hide&rdquo; action.</p>
<p><img loading="lazy" src="images/08.png" alt="file shares connection"  />
</p>
<p>If I SSH from the internal file server to the external file server the client IP for that connection will also show up at the firewall IP address.</p>
<p><img loading="lazy" src="images/09.png" alt="SSH works"  />
</p>
<p><img loading="lazy" src="images/10.png" alt="SSH connection establised"  />
</p>
<p>If you look at the log entry in the SmartLog you will see the NAT rule number matched as the automatic rule (Rule 6 in my case).</p>
<p><img loading="lazy" src="images/11.png" alt="NAT matched"  />
</p>
<h2 id="create-a-manual-nat-rule">Create a manual NAT rule.<a hidden class="anchor" aria-hidden="true" href="#create-a-manual-nat-rule">#</a></h2>
<p>Let&rsquo;s create a NAT entry that will translate the IP of the internal file server to <code>192.168.200.200</code> when connecting to the DMZ network instead of hiding behind the firewall IP address.</p>
<p>First start by creating an object with the translated IP address. Only configuring the name and IP address are required. Don&rsquo;t configure anything else.</p>
<p><img loading="lazy" src="images/12.png" alt="NAT host object"  />
</p>
<p>Now add a rule to the top by clicking on the &ldquo;add rule&rdquo; button and choosing &ldquo;Add rule to top&rdquo;.</p>
<p><img loading="lazy" src="images/13.png" alt="Add NAT rule"  />
</p>
<p>Create a rule as shown below:</p>
<ul>
<li>Original Source &ndash;&gt; Internal Fileserver</li>
<li>Original Destination &ndash;&gt; DMZ network</li>
<li>Translated Source &ndash;&gt; Translated IP host object created above</li>
<li>Translated Destination &ndash;&gt; Original</li>
</ul>
<p>And install the policy. NAT rules like any rule, needs to the policy to be installed before becoming active.</p>
<p><img loading="lazy" src="images/14.png" alt="Internal file server static NAT"  />
</p>
<p>Now from the internal file server try to SSH to the external file server.</p>
<p>Hmmm, it doesn&rsquo;t seem to work. Maybe it&rsquo;s not allowed? Let&rsquo;s check the log.</p>
<p><img loading="lazy" src="images/15.png" alt="Connection failed"  />
</p>
<p>The log entry seems to indicate that the traffic is allowed. And the translation is correct, the internal file server is being translated to <code>192.168.200.200</code> and it&rsquo;s matching NAT rule 1.</p>
<p><img loading="lazy" src="images/16.png" alt="Log looks fine to me"  />
</p>
<p>If you look at the ARP table on the external file server, you will see that the ARP entry for 192.168.200.200 is incomplete. The external file server sees that that IP is on its local network and is sending out an ARP request, but is getting no response.</p>
<p>This is because the firewall needs to be configured for Proxy ARP to respond to ARP requests that it does not &ldquo;own&rdquo;.</p>
<p><img loading="lazy" src="images/17.png" alt="Incomplete ARP"  />
</p>
<p>As of Check Point R80.10 you can configure the firewall for the automatic creation of proxy ARP for manual NAT rules as per <a href="https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&amp;solutionid=sk114395">SK114395</a>.</p>
<p>This requires connecting in expert mode, which you can access via the &ldquo;CLI&rdquo; icon in the web interface, or by an SSH connection to the firewall from a PC. I prefer the latter as the web-based &ldquo;CLI&rdquo; sucks.</p>
<p><img loading="lazy" src="images/18.png" alt="Accessing Expert mode"  />
</p>
<p>If you&rsquo;re not comfortable with using the CLI, then you can add manual proxy ARP entries based on <a href="https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&amp;solutionid=sk30197">sk30197</a> using the Gaia web interface.</p>
<p>Go to &ldquo;Network Management&rdquo; &ndash;&gt; &ldquo;ARP&rdquo;. Then in the &ldquo;Proxy ARP&rdquo; section click &ldquo;Add&rdquo; to add your entry. Note that you need to install your policy in order for this to take effect.</p>
<p>You will also need to go to the &ldquo;NAT&rdquo; pane of the &ldquo;Global Properties&rdquo; and ensure that &ldquo;Merge manual proxy ARP configuration&rdquo; is checked.</p>
<p>I opted to go with the automatic option because the CLI doesn&rsquo;t scare me, and I didn&rsquo;t want add proxy ARP setting every time.</p>
<p>You should also note that these settings don&rsquo;t keep with upgrades, so you&rsquo;ll need to recreate them when you do an upgrade.</p>
<p><img loading="lazy" src="images/19.png" alt="Manual proxy ARP setting"  />
</p>
<p><img loading="lazy" src="images/52.png" alt="Merge manual proxy ARP"  />
</p>
<p>Once the proxy ARP is setup, we can try to connect via SSH and it should work now. You may need to install your policy if it doesn&rsquo;t work, otherwise, recheck your settings.</p>
<p><img loading="lazy" src="images/20.png" alt="SSH works now"  />
</p>
<p>If you look at the ARP table on the server, you&rsquo;ll see that the ARP entry is now showing. And if you check your connections you&rsquo;ll see the client IP as the translated IP (<code>192.168.200.200</code> in my case).</p>
<p><img loading="lazy" src="images/21.png" alt="ARP entries correct"  />
</p>
<p>I&rsquo;ll create the reverse connection that we&rsquo;ll utilise later. Here I&rsquo;m not only configuring the reverse connection from the DMZ network to the NAT entry for the internal file server, but also maintaining the real IP address of the DMZ host when connecting, so it&rsquo;s not being translated by the automatic rules.</p>
<p><img loading="lazy" src="images/22.png" alt="Reverse NAT to internal file server"  />
</p>
<h2 id="dynamic-nat">Dynamic NAT<a hidden class="anchor" aria-hidden="true" href="#dynamic-nat">#</a></h2>
<p>When my two Linux clients SSH to the external file server, their IPs are being hidden by the firewall&rsquo;s IP address. Suppose I want to hide these clients behind a different IP for some reason. Let&rsquo;s do that.</p>
<p><img loading="lazy" src="images/23.png" alt="Clients hidden by firewall"  />
</p>
<p>First, create a host object with the translated IP that we&rsquo;ll use, in this case <code>192.168.200.210</code>.</p>
<p><img loading="lazy" src="images/24.png" alt="Dynamic NAT host"  />
</p>
<p>Then create a rule by setting the translated source as the NAT object created above. Then install the policy.</p>
<p><img loading="lazy" src="images/25.png" alt="NAT entry for clients to hide behind a different IP"  />
</p>
<p>Oh, oh. It seems that the policy install failed. Click on &ldquo;Details&rdquo; to see more about why.</p>
<p><img loading="lazy" src="images/26.png" alt="Failed policy install for dynamic NAT"  />
</p>
<p>It failed because the range size is not the same. This is because by default Check Point will set the translated objects as static NAT and you need to change the Dynamic NAT.</p>
<p><img loading="lazy" src="images/27.png" alt="Policy failed because NAT size don&amp;rsquo;t match"  />
</p>
<p>Go to the NAT rule and right-click on the translated source object. Go to &ldquo;NAT Method&rdquo; and choose &ldquo;Hide&rdquo;. This sets the NAT entry to dynamic.</p>
<p><img loading="lazy" src="images/28.png" alt="Change to Hide"  />
</p>
<p>The entry will now show a little &ldquo;H&rdquo; instead of &ldquo;S&rdquo; to indicate &ldquo;Hide&rdquo;.</p>
<p><img loading="lazy" src="images/29.png" alt="Hide NAT"  />
</p>
<p>Now when you install the policy it should install successfully.</p>
<p><img loading="lazy" src="images/30.png" alt="Successful policy install"  />
</p>
<p>Now when the clients connect to the external file server, the connection entries show the translated IP of <code>192.168.200.210</code>.</p>
<p><img loading="lazy" src="images/31.png" alt="Translated IPs shown connected"  />
</p>
<p>If you connect from the internal file server it still shows as <code>192.168.200.200</code>. This is because that NAT rule is above the client rule we just created. If we put the new client NAT rule at the top, then all the connections, even from the internal file server, would show to come from <code>192.168.200.210</code>.</p>
<p><img loading="lazy" src="images/32.png" alt="connections from clients and internal file server"  />
</p>
<h2 id="no-nat">No NAT<a hidden class="anchor" aria-hidden="true" href="#no-nat">#</a></h2>
<p>I would have created a rule to allow the external file server to access the internal file server via SSH and disabled it. You can disable or enable a rule by right-clicking on it and selecting &ldquo;Disable&rdquo;. Disabled rules are shown as &ldquo;greyed out&rdquo;.</p>
<p><img loading="lazy" src="images/33.png" alt="Enabling a disabled rule"  />
</p>
<p>The rule allows access from the real IP of the external file server, to the real IP of the internal file server.</p>
<p><img loading="lazy" src="images/34.png" alt="Rule to allow access to internal file server from DMZ"  />
</p>
<p>When the connection is attempted it&rsquo;s successful, and viewing the connection table on the internal file server shows the client IP as the firewall IP address.</p>
<p>So even though we&rsquo;ve created as static NAT for the internal file server when connecting to the DMZ and vice-versa it doesn&rsquo;t prevent connections to the real IP address if the rules allow it.</p>
<p><img loading="lazy" src="images/35.png" alt="connection table showing DMZ client hidden behind firewall"  />
</p>
<p>When you try to connect to the translated IP of the internal file server it is not successful.</p>
<p><img loading="lazy" src="images/36.png" alt="access denied"  />
</p>
<p>Reviewing the log entries shows the connection to the real IP as allowed, but the connection to the translated IP as denied.</p>
<p><img loading="lazy" src="images/37.png" alt="rules showing connection to the internal file server"  />
</p>
<p>To allow only access to the translated IP the rule must be altered with the destination as the NAT host object as shown below.</p>
<p><img loading="lazy" src="images/38.png" alt="NAT entry in rulebase"  />
</p>
<p>Now a reattempt to SSH to the translated IP <code>192.168.200.200</code> is successful.</p>
<p><img loading="lazy" src="images/39.png" alt="SSH works now to translated IP"  />
</p>
<p>And the connection table on the file server shows the connection coming from <code>192.168.200.15</code>, which is expected as the NAT rule 2 had the translated source as &ldquo;original&rdquo;, which means unchanged.</p>
<p><img loading="lazy" src="images/40.png" alt="connection established showing real client IP"  />
</p>
<p>The logs show the access is allowed via rule 7.</p>
<p><img loading="lazy" src="images/41.png" alt="traffic is allowed"  />
</p>
<p>And the log details show that the NAT rule 2 is being matched as expected.</p>
<p><img loading="lazy" src="images/42.png" alt="NAT rule matched"  />
</p>
<h2 id="pat-and-hosting-services-on-the-firewall-ip">PAT and hosting services on the firewall IP<a hidden class="anchor" aria-hidden="true" href="#pat-and-hosting-services-on-the-firewall-ip">#</a></h2>
<p>As is typical now, many Internet Service Providers (ISP) limit the number of public IP addresses that they provide to customers, and nowadays you may have only one public IP to use. This public IP is the one used on the firewall. So if you have services hosted internally that you want to make public, how would you do that?</p>
<p>Here is where PAT comes in. It allows you to create NAT rules for ports only to allow you allow the traffic through.</p>
<p>In the lab I have a web server hosted at <code>192.168.200.10</code>.</p>
<p><img loading="lazy" src="images/43.png" alt="Web server"  />
</p>
<p>Create a NAT rule for traffic to the destination as the firewall gateway object and original service as the service you&rsquo;re allowing through, in my case HTTP (port 80). The translated destination is the webserver object, and it&rsquo;s left as static NAT.</p>
<p>Note that if the firewall object does not use the external IP as the main definition, then you will need to create an object with that IP to use as the original destination.</p>
<p><img loading="lazy" src="images/44.png" alt="NAT rule for firewall interface"  />
</p>
<p>Now go to the security policy and create a rule to allow access to the firewall object (or IP object if necessary), setting the service, in this case HTTP.</p>
<p><img loading="lazy" src="images/45.png" alt="create rule to allow access"  />
</p>
<p>Oh oh, another error on policy install. This time it says that the rule 3 conflicts with rule 8.</p>
<p>The reason is that rule 3 blocks the traffic to the gateway object, so that rule 8 is not effective. This is one of the things I like with Check Point validation - it&rsquo;s very good.</p>
<p><img loading="lazy" src="images/46.png" alt="Policy install for gateway NAT failed"  />
</p>
<p>To fix this I need to move the rule above the stealth rule, as the traffic is destined to the firewall itself.</p>
<p><img loading="lazy" src="images/47.png" alt="move rule above stealth rule"  />
</p>
<p>Now my policy installed successfully, and you should be able to access the exposed server via the IP address of the firewall, in my case <code>192.168.1.41</code>.</p>
<p><img loading="lazy" src="images/48.png" alt="Web works"  />
</p>
<p>Now, let&rsquo;s say I want to access the web server securely using HTTPS. However, I have an issue as the default HTTPS port is being utilised by Gaia. Yes, I could change the default port for Gaia to something else (and this is very much recommended practice), but I will server the HTTPS page of my web server using port 8080 instead.</p>
<p>I create another NAT rule, but this time I set the original service as <code>HTTPS_proxy</code>, which is TCP port 8080, and set the translated service as <code>https</code>.</p>
<p><img loading="lazy" src="images/49.png" alt="NAT rule for HTTPS"  />
</p>
<p>Then modify the access rule to allow <code>HTTPS_proxy</code> in the services, and install the policy.</p>
<p><img loading="lazy" src="images/50.png" alt="modify policy to allow 8080"  />
</p>
<p>Now I can access the web page by going to <code>https:\\192.168.1.41:8080</code>.</p>
<p><img loading="lazy" src="images/51.png" alt="HTTPS page via port 8080"  />
</p>
<h2 id="in-conclusion">In conclusion<a hidden class="anchor" aria-hidden="true" href="#in-conclusion">#</a></h2>
<p>There are much more to Check Point than just this small series, but these basic items will get you though 80% or more of the things you need to do.</p>
<p>As time progresses I&rsquo;ll post more stuff such as distributed setups, the IPS (which I still lovingly call SYNDefender) and Identity Awareness. I also want to explore some of the newer features with the networking components as I&rsquo;ve never thought that Check Point&rsquo;s network functionality was strong and what to see if that has changed.</p>
<p>I hope you&rsquo;ve found this helpful. Feel free to connect with me and give me feedback.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://essgeelabs.com/tags/lab/">lab</a></li>
      <li><a href="https://essgeelabs.com/tags/networking/">networking</a></li>
      <li><a href="https://essgeelabs.com/tags/firewalls/">firewalls</a></li>
      <li><a href="https://essgeelabs.com/tags/cybersecurity/">cybersecurity</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://essgeelabs.com/posts/the-check-point-firewall-log-viewer/">
    <span class="title">Next Page »</span>
    <br>
    <span>The Check Point Firewall Log Viewer</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share NAT on Check Point Firewall on twitter"
        href="https://twitter.com/intent/tweet/?text=NAT%20on%20Check%20Point%20Firewall&amp;url=https%3a%2f%2fessgeelabs.com%2fposts%2fnat-on-check-point-firewall%2f&amp;hashtags=lab%2cnetworking%2cfirewalls%2ccybersecurity">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share NAT on Check Point Firewall on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fessgeelabs.com%2fposts%2fnat-on-check-point-firewall%2f&amp;title=NAT%20on%20Check%20Point%20Firewall&amp;summary=NAT%20on%20Check%20Point%20Firewall&amp;source=https%3a%2f%2fessgeelabs.com%2fposts%2fnat-on-check-point-firewall%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share NAT on Check Point Firewall on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fessgeelabs.com%2fposts%2fnat-on-check-point-firewall%2f&title=NAT%20on%20Check%20Point%20Firewall">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share NAT on Check Point Firewall on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fessgeelabs.com%2fposts%2fnat-on-check-point-firewall%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share NAT on Check Point Firewall on whatsapp"
        href="https://api.whatsapp.com/send?text=NAT%20on%20Check%20Point%20Firewall%20-%20https%3a%2f%2fessgeelabs.com%2fposts%2fnat-on-check-point-firewall%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share NAT on Check Point Firewall on telegram"
        href="https://telegram.me/share/url?text=NAT%20on%20Check%20Point%20Firewall&amp;url=https%3a%2f%2fessgeelabs.com%2fposts%2fnat-on-check-point-firewall%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://essgeelabs.com/">Ess Gee Labs</a></span>
    <span>
        running Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a> & 
        Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
